<h1>CHARTS FOR DAYS</h1>

<%= render partial: "shared/search_form" %>	

<div id="container" style="width:100%; height:600px;"></div>

<script>
$(function () { 
    $('#container').highcharts({
        chart: {
            type: '<%= @chart.main_chart %>'
        },
        legend: {
        	enabled: false
        },
        title: {
            text: 'Team Salary'
        },
        xAxis: {
            type: 'category'
        },
        yAxis: {
            title: {
                text: 'Salary'
            }
         },
         tooltip: {
            formatter: function () {
                return '<b>' + this.point.name + '</b>: $' + Highcharts.numberFormat(this.y, 0, '.', ',') + '<br/>'
            }
        },     
         series: [{
            name: 'Teams',
            colorByPoint: true,
            data: [
            <% @chart.teams.each_with_index do |t, i| %>{
                name: '<%= t.abbr %>',
                y: <%= t.contracts.year(params[:year]).sum(:salary).floor %>,
                drilldown: '<%= t.abbr %>'
            }<% if i != @chart.teams.size - 1 %>,<% end %>
            <%end%>
            ]
        }],
        
        drilldown: {
        	animation: {
		        duration: 500
		    },
            series: [
            <% @chart.teams.each_with_index do |t, i| %>{
                id: '<%= t.abbr %>',
                type: '<%= @chart.drill_chart %>',
                data:[ 
                <% t.contracts.year(params[:year]).each_with_index do |c, ix| %>
                	["<%== c.player.name%>", <%=c.salary.floor%>]<% if ix != t.contracts.size - 1 %>,<% end %>
                    <% end %>
                    ]
                    
            }<% if i != @chart.teams.size - 1 %>,<% end %>
            <%end%>
            ]
        }
    });
});
</script>
